k = 0
j = 0


===== gpu_house =====
R[u:, u]
[[0.73965 ]
 [0.531328]
 [0.345287]
 [0.003725]
 [0.714051]
 [0.161034]
 [0.579799]
 [0.714628]]
u = 0
v = 
[[-0.787206]
 [ 0.531328]
 [ 0.345287]
 [ 0.003725]
 [ 0.714051]
 [ 0.161034]
 [ 0.579799]
 [ 0.714628]]
beta = 0.8319808704712627


===== cublasDgemv =====
R = 
[[0.73965  0.867264 0.04298  0.276388]
 [0.531328 0.447219 0.567332 0.800273]
 [0.345287 0.652109 0.417846 0.215248]
 [0.003725 0.485716 0.865785 0.491661]
 [0.714051 0.550522 0.303325 0.041883]
 [0.161034 0.516564 0.964321 0.172027]
 [0.579799 0.196588 0.305231 0.669348]
 [0.714628 0.261337 0.803849 0.349297]]
R[u:m, u:(s + r)]
[[0.73965  0.867264 0.04298  0.276388]
 [0.531328 0.447219 0.567332 0.800273]
 [0.345287 0.652109 0.417846 0.215248]
 [0.003725 0.485716 0.865785 0.491661]
 [0.714051 0.550522 0.303325 0.041883]
 [0.161034 0.516564 0.964321 0.172027]
 [0.579799 0.196588 0.305231 0.669348]
 [0.714628 0.261337 0.803849 0.349297]]
v
[[-0.787206]
 [ 0.531328]
 [ 0.345287]
 [ 0.003725]
 [ 0.714051]
 [ 0.161034]
 [ 0.579799]
 [ 0.714628]]
v.T @ R[u:m, u:(s + r)] = 
[[1.201951 0.558904 1.538411 0.9791  ]]


===== cublasDger =====
v
[[-0.787206]
 [ 0.531328]
 [ 0.345287]
 [ 0.003725]
 [ 0.714051]
 [ 0.161034]
 [ 0.579799]
 [ 0.714628]]
v.T @ R[u:m, u:(s + r)] = 
[[1.201951 0.558904 1.538411 0.9791  ]]
B[j]
0.8319808704712627
rows = 8, cols = 4
R[u:m, u:(s + r)] - beta * v @ (v.T @ R[u:m, u:(s + r)])
[[ 1.526856  1.233313  1.050548  0.917641]
 [ 0.        0.200153 -0.11273   0.367457]
 [ 0.        0.491551 -0.024097 -0.06602 ]
 [ 0.        0.483984  0.861017  0.488626]
 [ 0.        0.21849  -0.610609 -0.539777]
 [ 0.        0.441684  0.758209  0.04085 ]
 [ 0.       -0.073017 -0.436871  0.197048]
 [ 0.       -0.070963 -0.110823 -0.232834]]
===== R at end of j loop =====
[[ 1.526856  1.233313  1.050548  0.917641]
 [ 0.        0.200153 -0.11273   0.367457]
 [ 0.        0.491551 -0.024097 -0.06602 ]
 [ 0.        0.483984  0.861017  0.488626]
 [ 0.        0.21849  -0.610609 -0.539777]
 [ 0.        0.441684  0.758209  0.04085 ]
 [ 0.       -0.073017 -0.436871  0.197048]
 [ 0.       -0.070963 -0.110823 -0.232834]]
j = 1


===== gpu_house =====
R[u:, u]
[[ 0.200153]
 [ 0.491551]
 [ 0.483984]
 [ 0.21849 ]
 [ 0.441684]
 [-0.073017]
 [-0.070963]]
u = 1
v = 
[[-0.676838]
 [ 0.491551]
 [ 0.483984]
 [ 0.21849 ]
 [ 0.441684]
 [-0.073017]
 [-0.070963]]
beta = 1.684689687752134


===== cublasDgemv =====
R = 
[[ 1.526856  1.233313  1.050548  0.917641]
 [ 0.        0.200153 -0.11273   0.367457]
 [ 0.        0.491551 -0.024097 -0.06602 ]
 [ 0.        0.483984  0.861017  0.488626]
 [ 0.        0.21849  -0.610609 -0.539777]
 [ 0.        0.441684  0.758209  0.04085 ]
 [ 0.       -0.073017 -0.436871  0.197048]
 [ 0.       -0.070963 -0.110823 -0.232834]]
R[u:m, u:(s + r)]
[[ 0.200153 -0.11273   0.367457]
 [ 0.491551 -0.024097 -0.06602 ]
 [ 0.483984  0.861017  0.488626]
 [ 0.21849  -0.610609 -0.539777]
 [ 0.441684  0.758209  0.04085 ]
 [-0.073017 -0.436871  0.197048]
 [-0.070963 -0.110823 -0.232834]]
v
[[-0.676838]
 [ 0.491551]
 [ 0.483984]
 [ 0.21849 ]
 [ 0.441684]
 [-0.073017]
 [-0.070963]]
v.T @ R[u:m, u:(s + r)] = 
[[ 0.593581  0.722414 -0.142432]]


===== cublasDger =====
v
[[-0.676838]
 [ 0.491551]
 [ 0.483984]
 [ 0.21849 ]
 [ 0.441684]
 [-0.073017]
 [-0.070963]]
v.T @ R[u:m, u:(s + r)] = 
[[ 0.593581  0.722414 -0.142432]]
B[j]
1.684689687752134
rows = 7, cols = 3
R[u:m, u:(s + r)] - beta * v @ (v.T @ R[u:m, u:(s + r)])
[[ 0.876991  0.711011  0.205047]
 [ 0.       -0.622335  0.051929]
 [ 0.        0.271988  0.60476 ]
 [ 0.       -0.876521 -0.48735 ]
 [ 0.        0.220661  0.146834]
 [-0.       -0.348006  0.179527]
 [ 0.       -0.024458 -0.249862]]
===== R at end of j loop =====
[[ 1.526856  1.233313  1.050548  0.917641]
 [ 0.        0.876991  0.711011  0.205047]
 [ 0.        0.       -0.622335  0.051929]
 [ 0.        0.        0.271988  0.60476 ]
 [ 0.        0.       -0.876521 -0.48735 ]
 [ 0.        0.        0.220661  0.146834]
 [ 0.       -0.       -0.348006  0.179527]
 [ 0.        0.       -0.024458 -0.249862]]
j = 2


===== gpu_house =====
R[u:, u]
[[-0.622335]
 [ 0.271988]
 [-0.876521]
 [ 0.220661]
 [-0.348006]
 [-0.024458]]
u = 2
v = 
[[-1.805536]
 [ 0.271988]
 [-0.876521]
 [ 0.220661]
 [-0.348006]
 [-0.024458]]
beta = 0.4680963327760191


===== cublasDgemv =====
R = 
[[ 1.526856  1.233313  1.050548  0.917641]
 [ 0.        0.876991  0.711011  0.205047]
 [ 0.        0.       -0.622335  0.051929]
 [ 0.        0.        0.271988  0.60476 ]
 [ 0.        0.       -0.876521 -0.48735 ]
 [ 0.        0.        0.220661  0.146834]
 [ 0.       -0.       -0.348006  0.179527]
 [ 0.        0.       -0.024458 -0.249862]]
R[u:m, u:(s + r)]
[[-0.622335  0.051929]
 [ 0.271988  0.60476 ]
 [-0.876521 -0.48735 ]
 [ 0.220661  0.146834]
 [-0.348006  0.179527]
 [-0.024458 -0.249862]]
v
[[-1.805536]
 [ 0.271988]
 [-0.876521]
 [ 0.220661]
 [-0.348006]
 [-0.024458]]
v.T @ R[u:m, u:(s + r)] = 
[[2.136312 0.473935]]


===== cublasDger =====
v
[[-1.805536]
 [ 0.271988]
 [-0.876521]
 [ 0.220661]
 [-0.348006]
 [-0.024458]]
v.T @ R[u:m, u:(s + r)] = 
[[2.136312 0.473935]]
B[j]
0.4680963327760191
rows = 6, cols = 2
R[u:m, u:(s + r)] - beta * v @ (v.T @ R[u:m, u:(s + r)])
[[ 1.183201  0.452482]
 [ 0.        0.544421]
 [ 0.       -0.292896]
 [-0.        0.097881]
 [ 0.        0.256731]
 [ 0.       -0.244436]]
===== R at end of j loop =====
[[ 1.526856  1.233313  1.050548  0.917641]
 [ 0.        0.876991  0.711011  0.205047]
 [ 0.        0.        1.183201  0.452482]
 [ 0.        0.        0.        0.544421]
 [ 0.        0.        0.       -0.292896]
 [ 0.        0.       -0.        0.097881]
 [ 0.       -0.        0.        0.256731]
 [ 0.        0.        0.       -0.244436]]
j = 3


===== gpu_house =====
R[u:, u]
[[ 0.544421]
 [-0.292896]
 [ 0.097881]
 [ 0.256731]
 [-0.244436]]
u = 3
v = 
[[-0.1749  ]
 [-0.292896]
 [ 0.097881]
 [ 0.256731]
 [-0.244436]]
beta = 7.948539705333845


===== cublasDgemv =====
R = 
[[ 1.526856  1.233313  1.050548  0.917641]
 [ 0.        0.876991  0.711011  0.205047]
 [ 0.        0.        1.183201  0.452482]
 [ 0.        0.        0.        0.544421]
 [ 0.        0.        0.       -0.292896]
 [ 0.        0.       -0.        0.097881]
 [ 0.       -0.        0.        0.256731]
 [ 0.        0.        0.       -0.244436]]
R[u:m, u:(s + r)]
[[ 0.544421]
 [-0.292896]
 [ 0.097881]
 [ 0.256731]
 [-0.244436]]
v
[[-0.1749  ]
 [-0.292896]
 [ 0.097881]
 [ 0.256731]
 [-0.244436]]
v.T @ R[u:m, u:(s + r)] = 
[[0.125809]]


===== cublasDger =====
v
[[-0.1749  ]
 [-0.292896]
 [ 0.097881]
 [ 0.256731]
 [-0.244436]]
v.T @ R[u:m, u:(s + r)] = 
[[0.125809]]
B[j]
7.948539705333845
rows = 5, cols = 1
R[u:m, u:(s + r)] - beta * v @ (v.T @ R[u:m, u:(s + r)])
[[ 0.719321]
 [-0.      ]
 [ 0.      ]
 [ 0.      ]
 [-0.      ]]
===== R at end of j loop =====
[[ 1.526856  1.233313  1.050548  0.917641]
 [ 0.        0.876991  0.711011  0.205047]
 [ 0.        0.        1.183201  0.452482]
 [ 0.        0.        0.        0.719321]
 [ 0.        0.        0.       -0.      ]
 [ 0.        0.       -0.        0.      ]
 [ 0.       -0.        0.        0.      ]
 [ 0.        0.        0.       -0.      ]]
===== GENERATING W, Y =====
=====  i = 1  =====
Y = 
[[-0.787206]
 [ 0.531328]
 [ 0.345287]
 [ 0.003725]
 [ 0.714051]
 [ 0.161034]
 [ 0.579799]
 [ 0.714628]]
v = 
[[ 0.      ]
 [-0.676838]
 [ 0.491551]
 [ 0.483984]
 [ 0.21849 ]
 [ 0.441684]
 [-0.073017]
 [-0.070963]]
Y.T @ v
[[-0.054002]]
W
[[ 0.654941]
 [-0.442055]
 [-0.287273]
 [-0.003099]
 [-0.594077]
 [-0.133977]
 [-0.482382]
 [-0.594557]]
WYt_v = -B[j] * (W @ (Y.T @ v))
[[ 0.059584]
 [-0.040217]
 [-0.026135]
 [-0.000282]
 [-0.054047]
 [-0.012189]
 [-0.043886]
 [-0.054091]]
z = 
[[ 0.059584]
 [ 1.100046]
 [-0.854246]
 [-0.815644]
 [-0.422135]
 [-0.756289]
 [ 0.079125]
 [ 0.06546 ]]
Y
[[-0.787206  0.      ]
 [ 0.531328 -0.676838]
 [ 0.345287  0.491551]
 [ 0.003725  0.483984]
 [ 0.714051  0.21849 ]
 [ 0.161034  0.441684]
 [ 0.579799 -0.073017]
 [ 0.714628 -0.070963]]
W
[[ 0.654941  0.059584]
 [-0.442055  1.100046]
 [-0.287273 -0.854246]
 [-0.003099 -0.815644]
 [-0.594077 -0.422135]
 [-0.133977 -0.756289]
 [-0.482382  0.079125]
 [-0.594557  0.06546 ]]
=====  i = 2  =====
Y = 
[[-0.787206  0.      ]
 [ 0.531328 -0.676838]
 [ 0.345287  0.491551]
 [ 0.003725  0.483984]
 [ 0.714051  0.21849 ]
 [ 0.161034  0.441684]
 [ 0.579799 -0.073017]
 [ 0.714628 -0.070963]]
v = 
[[ 0.      ]
 [ 0.      ]
 [-1.805536]
 [ 0.271988]
 [-0.876521]
 [ 0.220661]
 [-0.348006]
 [-0.024458]]
Y.T @ v
[[-1.432015]
 [-0.822778]]
W
[[ 0.654941  0.059584]
 [-0.442055  1.100046]
 [-0.287273 -0.854246]
 [-0.003099 -0.815644]
 [-0.594077 -0.422135]
 [-0.133977 -0.756289]
 [-0.482382  0.079125]
 [-0.594557  0.06546 ]]
WYt_v = -B[j] * (W @ (Y.T @ v))
[[ 0.461969]
 [ 0.127352]
 [-0.521568]
 [-0.316214]
 [-0.560803]
 [-0.381084]
 [-0.292876]
 [-0.373332]]
z = 
[[ 0.461969]
 [ 0.127352]
 [ 0.323597]
 [-0.443531]
 [-0.150507]
 [-0.484375]
 [-0.129976]
 [-0.361884]]
Y
[[-0.787206  0.        0.      ]
 [ 0.531328 -0.676838  0.      ]
 [ 0.345287  0.491551 -1.805536]
 [ 0.003725  0.483984  0.271988]
 [ 0.714051  0.21849  -0.876521]
 [ 0.161034  0.441684  0.220661]
 [ 0.579799 -0.073017 -0.348006]
 [ 0.714628 -0.070963 -0.024458]]
W
[[ 0.654941  0.059584  0.461969]
 [-0.442055  1.100046  0.127352]
 [-0.287273 -0.854246  0.323597]
 [-0.003099 -0.815644 -0.443531]
 [-0.594077 -0.422135 -0.150507]
 [-0.133977 -0.756289 -0.484375]
 [-0.482382  0.079125 -0.129976]
 [-0.594557  0.06546  -0.361884]]
=====  i = 3  =====
Y = 
[[-0.787206  0.        0.      ]
 [ 0.531328 -0.676838  0.      ]
 [ 0.345287  0.491551 -1.805536]
 [ 0.003725  0.483984  0.271988]
 [ 0.714051  0.21849  -0.876521]
 [ 0.161034  0.441684  0.220661]
 [ 0.579799 -0.073017 -0.348006]
 [ 0.714628 -0.070963 -0.024458]]
v = 
[[ 0.      ]
 [ 0.      ]
 [ 0.      ]
 [-0.1749  ]
 [-0.292896]
 [ 0.097881]
 [ 0.256731]
 [-0.244436]]
Y.T @ v
[[-0.21986 ]
 [-0.106811]
 [ 0.147392]]
W
[[ 0.654941  0.059584  0.461969]
 [-0.442055  1.100046  0.127352]
 [-0.287273 -0.854246  0.323597]
 [-0.003099 -0.815644 -0.443531]
 [-0.594077 -0.422135 -0.150507]
 [-0.133977 -0.756289 -0.484375]
 [-0.482382  0.079125 -0.129976]
 [-0.594557  0.06546  -0.361884]]
WYt_v = -B[j] * (W @ (Y.T @ v))
[[ 0.653922]
 [ 0.012209]
 [-1.606386]
 [-0.178273]
 [-1.220254]
 [-0.308748]
 [-0.623546]
 [-0.559489]]
z = 
[[ 0.653922]
 [ 0.012209]
 [-1.606386]
 [ 1.211927]
 [ 1.107843]
 [-1.086758]
 [-2.664182]
 [ 1.383418]]
Y
[[-0.787206  0.        0.        0.      ]
 [ 0.531328 -0.676838  0.        0.      ]
 [ 0.345287  0.491551 -1.805536  0.      ]
 [ 0.003725  0.483984  0.271988 -0.1749  ]
 [ 0.714051  0.21849  -0.876521 -0.292896]
 [ 0.161034  0.441684  0.220661  0.097881]
 [ 0.579799 -0.073017 -0.348006  0.256731]
 [ 0.714628 -0.070963 -0.024458 -0.244436]]
W
[[ 0.654941  0.059584  0.461969  0.653922]
 [-0.442055  1.100046  0.127352  0.012209]
 [-0.287273 -0.854246  0.323597 -1.606386]
 [-0.003099 -0.815644 -0.443531  1.211927]
 [-0.594077 -0.422135 -0.150507  1.107843]
 [-0.133977 -0.756289 -0.484375 -1.086758]
 [-0.482382  0.079125 -0.129976 -2.664182]
 [-0.594557  0.06546  -0.361884  1.383418]]
===== COMPLETED W, Y UPDATE =====
W = 
[[ 0.654941  0.059584  0.461969  0.653922]
 [-0.442055  1.100046  0.127352  0.012209]
 [-0.287273 -0.854246  0.323597 -1.606386]
 [-0.003099 -0.815644 -0.443531  1.211927]
 [-0.594077 -0.422135 -0.150507  1.107843]
 [-0.133977 -0.756289 -0.484375 -1.086758]
 [-0.482382  0.079125 -0.129976 -2.664182]
 [-0.594557  0.06546  -0.361884  1.383418]]
Y = 
[[-0.787206  0.        0.        0.      ]
 [ 0.531328 -0.676838  0.        0.      ]
 [ 0.345287  0.491551 -1.805536  0.      ]
 [ 0.003725  0.483984  0.271988 -0.1749  ]
 [ 0.714051  0.21849  -0.876521 -0.292896]
 [ 0.161034  0.441684  0.220661  0.097881]
 [ 0.579799 -0.073017 -0.348006  0.256731]
 [ 0.714628 -0.070963 -0.024458 -0.244436]]
dev_WTR = 
[]
(4, 8)
(8, 0)
Y @ (W.T @ R[s:, s + r:])
[]
Y
[[-0.787206  0.        0.        0.      ]
 [ 0.531328 -0.676838  0.        0.      ]
 [ 0.345287  0.491551 -1.805536  0.      ]
 [ 0.003725  0.483984  0.271988 -0.1749  ]
 [ 0.714051  0.21849  -0.876521 -0.292896]
 [ 0.161034  0.441684  0.220661  0.097881]
 [ 0.579799 -0.073017 -0.348006  0.256731]
 [ 0.714628 -0.070963 -0.024458 -0.244436]]
s = 0
s + r = 4
R.shape = (8, 4)
R[s:, s+r:]
[]
dev_WTR = 
[]
dev_YWTR = 
[]
R Before AXPY
[[ 1.526856  1.233313  1.050548  0.917641]
 [ 0.        0.876991  0.711011  0.205047]
 [ 0.        0.        1.183201  0.452482]
 [ 0.        0.        0.        0.719321]
 [ 0.        0.        0.       -0.      ]
 [ 0.        0.       -0.        0.      ]
 [ 0.       -0.        0.        0.      ]
 [ 0.        0.        0.       -0.      ]]
R[s:, s + r:].shape
(8, 0)
s = 0
R after update
[]
===== FINAL R AFTER BLOCK k = 0 =====
[[ 1.526856  1.233313  1.050548  0.917641]
 [ 0.        0.876991  0.711011  0.205047]
 [ 0.        0.        1.183201  0.452482]
 [ 0.        0.        0.        0.719321]
 [ 0.        0.        0.       -0.      ]
 [ 0.        0.       -0.        0.      ]
 [ 0.       -0.        0.        0.      ]
 [ 0.        0.        0.       -0.      ]]
===== FINAL Q AFTER BLOCK k = 0 =====
[[ 0.484427  0.307659 -0.578669  0.042557 -0.115776  0.29773   0.382498  0.29267 ]
 [ 0.347988  0.020571  0.158153  0.56326  -0.190504  0.443984 -0.37781  -0.400066]
 [ 0.226143  0.42555  -0.103362 -0.04554  -0.204906 -0.509396 -0.629209  0.240071]
 [ 0.00244   0.550412  0.39881   0.272629 -0.146628 -0.340002  0.523249 -0.229725]
 [ 0.467661 -0.029933 -0.140883 -0.441218  0.291005 -0.206891  0.023172 -0.661703]
 [ 0.105467  0.4407    0.456541 -0.308201  0.481964  0.431129 -0.132897  0.235414]
 [ 0.379734 -0.309858  0.10701   0.467112  0.567098 -0.332184  0.075792  0.304062]
 [ 0.468039 -0.36021   0.480278 -0.310921 -0.498241 -0.011274  0.131601  0.241162]]
