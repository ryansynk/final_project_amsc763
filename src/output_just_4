test_gemm: Test PASSED
test_gemm_ptr: Test PASSED
test_gemv: Test PASSED
test_dot: Test PASSED
test_norm: Test PASSED
test_axpy: Test PASSED
qr PASS for problem size: (40, 20) in: 1 milliseconds
qr PASS for problem size: (60, 30) in: 4 milliseconds
qr PASS for problem size: (80, 40) in: 8 milliseconds
qr PASS for problem size: (100, 50) in: 15 milliseconds
qr PASS for problem size: (120, 60) in: 25 milliseconds
qr PASS for problem size: (140, 70) in: 40 milliseconds
qr PASS for problem size: (160, 80) in: 59 milliseconds
qr PASS for problem size: (180, 90) in: 86 milliseconds
test_qr: Test PASSED
k = 0
j = 0

===== gpu_house =====
R[u:, u]
 0.739650 
 0.531328 
 0.345287 
 0.003725 
 0.714051 
 0.161034 
 0.579799 
 0.714628 
u = 0
v = 
-0.787206 
 0.531328 
 0.345287 
 0.003725 
 0.714051 
 0.161034 
 0.579799 
 0.714628 
beta = -0.831981

===== cublasDgemv =====
R = 
 0.739650  0.867264  0.042980  0.276388 
 0.531328  0.447219  0.567332  0.800273 
 0.345287  0.652109  0.417846  0.215248 
 0.003725  0.485716  0.865785  0.491661 
 0.714051  0.550522  0.303325  0.041883 
 0.161034  0.516564  0.964321  0.172027 
 0.579799  0.196588  0.305231  0.669348 
 0.714628  0.261337  0.803849  0.349297 
R[u:m, u:(s + r)] = 
 0.739650  0.867264  0.042980  0.276388 
 0.531328  0.447219  0.567332  0.800273 
 0.345287  0.652109  0.417846  0.215248 
 0.003725  0.485716  0.865785  0.491661 
 0.714051  0.550522  0.303325  0.041883 
 0.161034  0.516564  0.964321  0.172027 
 0.579799  0.196588  0.305231  0.669348 
 0.714628  0.261337  0.803849  0.349297 
dev_Vmat[:, j] = 
-0.787206 
 0.531328 
 0.345287 
 0.003725 
 0.714051 
 0.161034 
 0.579799 
 0.714628 
R[u:m, u:(s + r)].T @ v

 1.201951 
 0.558904 
 1.538411 
 0.979100 

===== cublasDger =====
dev_Vmat[:, j] = 
-0.787206 
 0.531328 
 0.345287 
 0.003725 
 0.714051 
 0.161034 
 0.579799 
 0.714628 
dev_Rv + u
 1.201951 
 0.558904 
 1.538411 
 0.979100 
B[j] = -0.831981
rows = 8, cols = 4
R[u:m, u:(s + r)] = 
 1.526856  1.233313  1.050548  0.917641 
 0.000000  0.200153 -0.112730  0.367457 
 0.000000  0.491551 -0.024097 -0.066020 
 0.000000  0.483984  0.861017  0.488626 
 0.000000  0.218490 -0.610609 -0.539777 
 0.000000  0.441684  0.758209  0.040850 
 0.000000 -0.073017 -0.436871  0.197048 
 0.000000 -0.070963 -0.110823 -0.232834 
===== R at end of j loop =====
R = 
 1.526856  1.233313  1.050548  0.917641 
 0.000000  0.200153 -0.112730  0.367457 
 0.000000  0.491551 -0.024097 -0.066020 
 0.000000  0.483984  0.861017  0.488626 
 0.000000  0.218490 -0.610609 -0.539777 
 0.000000  0.441684  0.758209  0.040850 
 0.000000 -0.073017 -0.436871  0.197048 
 0.000000 -0.070963 -0.110823 -0.232834 
j = 1

===== gpu_house =====
R[u:, u]
 0.200153 
 0.491551 
 0.483984 
 0.218490 
 0.441684 
-0.073017 
-0.070963 
u = 1
v = 
-0.676838 
 0.491551 
 0.483984 
 0.218490 
 0.441684 
-0.073017 
-0.070963 
beta = -1.684690

===== cublasDgemv =====
R = 
 1.526856  1.233313  1.050548  0.917641 
 0.000000  0.200153 -0.112730  0.367457 
 0.000000  0.491551 -0.024097 -0.066020 
 0.000000  0.483984  0.861017  0.488626 
 0.000000  0.218490 -0.610609 -0.539777 
 0.000000  0.441684  0.758209  0.040850 
 0.000000 -0.073017 -0.436871  0.197048 
 0.000000 -0.070963 -0.110823 -0.232834 
R[u:m, u:(s + r)] = 
 0.200153 -0.112730  0.367457 
 0.491551 -0.024097 -0.066020 
 0.483984  0.861017  0.488626 
 0.218490 -0.610609 -0.539777 
 0.441684  0.758209  0.040850 
-0.073017 -0.436871  0.197048 
-0.070963 -0.110823 -0.232834 
dev_Vmat[:, j] = 
-0.676838 
 0.491551 
 0.483984 
 0.218490 
 0.441684 
-0.073017 
-0.070963 
R[u:m, u:(s + r)].T @ v

 0.593581 
 0.722414 
-0.142432 

===== cublasDger =====
dev_Vmat[:, j] = 
-0.676838 
 0.491551 
 0.483984 
 0.218490 
 0.441684 
-0.073017 
-0.070963 
dev_Rv + u
 0.593581 
 0.722414 
-0.142432 
B[j] = -1.684690
rows = 7, cols = 3
R[u:m, u:(s + r)] = 
 0.876991  0.711011  0.205047 
 0.000000 -0.622335  0.051929 
 0.000000  0.271988  0.604760 
-0.000000 -0.876521 -0.487350 
 0.000000  0.220661  0.146834 
-0.000000 -0.348006  0.179527 
-0.000000 -0.024458 -0.249862 
===== R at end of j loop =====
R = 
 1.526856  1.233313  1.050548  0.917641 
 0.000000  0.876991  0.711011  0.205047 
 0.000000  0.000000 -0.622335  0.051929 
 0.000000  0.000000  0.271988  0.604760 
 0.000000 -0.000000 -0.876521 -0.487350 
 0.000000  0.000000  0.220661  0.146834 
 0.000000 -0.000000 -0.348006  0.179527 
 0.000000 -0.000000 -0.024458 -0.249862 
j = 2

===== gpu_house =====
R[u:, u]
-0.622335 
 0.271988 
-0.876521 
 0.220661 
-0.348006 
-0.024458 
u = 2
v = 
-1.805536 
 0.271988 
-0.876521 
 0.220661 
-0.348006 
-0.024458 
beta = -0.468096

===== cublasDgemv =====
R = 
 1.526856  1.233313  1.050548  0.917641 
 0.000000  0.876991  0.711011  0.205047 
 0.000000  0.000000 -0.622335  0.051929 
 0.000000  0.000000  0.271988  0.604760 
 0.000000 -0.000000 -0.876521 -0.487350 
 0.000000  0.000000  0.220661  0.146834 
 0.000000 -0.000000 -0.348006  0.179527 
 0.000000 -0.000000 -0.024458 -0.249862 
R[u:m, u:(s + r)] = 
-0.622335  0.051929 
 0.271988  0.604760 
-0.876521 -0.487350 
 0.220661  0.146834 
-0.348006  0.179527 
-0.024458 -0.249862 
dev_Vmat[:, j] = 
-1.805536 
 0.271988 
-0.876521 
 0.220661 
-0.348006 
-0.024458 
R[u:m, u:(s + r)].T @ v

 2.136312 
 0.473935 

===== cublasDger =====
dev_Vmat[:, j] = 
-1.805536 
 0.271988 
-0.876521 
 0.220661 
-0.348006 
-0.024458 
dev_Rv + u
 2.136312 
 0.473935 
B[j] = -0.468096
rows = 6, cols = 2
R[u:m, u:(s + r)] = 
 1.183201  0.452482 
-0.000000  0.544421 
 0.000000 -0.292896 
-0.000000  0.097881 
 0.000000  0.256731 
 0.000000 -0.244436 
===== R at end of j loop =====
R = 
 1.526856  1.233313  1.050548  0.917641 
 0.000000  0.876991  0.711011  0.205047 
 0.000000  0.000000  1.183201  0.452482 
 0.000000  0.000000 -0.000000  0.544421 
 0.000000 -0.000000  0.000000 -0.292896 
 0.000000  0.000000 -0.000000  0.097881 
 0.000000 -0.000000  0.000000  0.256731 
 0.000000 -0.000000  0.000000 -0.244436 
j = 3

===== gpu_house =====
R[u:, u]
 0.544421 
-0.292896 
 0.097881 
 0.256731 
-0.244436 
u = 3
v = 
-0.174900 
-0.292896 
 0.097881 
 0.256731 
-0.244436 
beta = -7.948540

===== cublasDgemv =====
R = 
 1.526856  1.233313  1.050548  0.917641 
 0.000000  0.876991  0.711011  0.205047 
 0.000000  0.000000  1.183201  0.452482 
 0.000000  0.000000 -0.000000  0.544421 
 0.000000 -0.000000  0.000000 -0.292896 
 0.000000  0.000000 -0.000000  0.097881 
 0.000000 -0.000000  0.000000  0.256731 
 0.000000 -0.000000  0.000000 -0.244436 
R[u:m, u:(s + r)] = 
 0.544421 
-0.292896 
 0.097881 
 0.256731 
-0.244436 
dev_Vmat[:, j] = 
-0.174900 
-0.292896 
 0.097881 
 0.256731 
-0.244436 
R[u:m, u:(s + r)].T @ v

 0.125809 

===== cublasDger =====
dev_Vmat[:, j] = 
-0.174900 
-0.292896 
 0.097881 
 0.256731 
-0.244436 
dev_Rv + u
 0.125809 
B[j] = -7.948540
rows = 5, cols = 1
R[u:m, u:(s + r)] = 
 0.719321 
 0.000000 
-0.000000 
-0.000000 
 0.000000 
===== R at end of j loop =====
R = 
 1.526856  1.233313  1.050548  0.917641 
 0.000000  0.876991  0.711011  0.205047 
 0.000000  0.000000  1.183201  0.452482 
 0.000000  0.000000 -0.000000  0.719321 
 0.000000 -0.000000  0.000000  0.000000 
 0.000000  0.000000 -0.000000 -0.000000 
 0.000000 -0.000000  0.000000 -0.000000 
 0.000000 -0.000000  0.000000  0.000000 

===== GENERATING W, Y =====
=====  i = 1  =====
Y = 
-0.787206  0.000000  0.000000  0.000000 
 0.531328  0.000000  0.000000  0.000000 
 0.345287  0.000000  0.000000  0.000000 
 0.003725  0.000000  0.000000  0.000000 
 0.714051  0.000000  0.000000  0.000000 
 0.161034  0.000000  0.000000  0.000000 
 0.579799  0.000000  0.000000  0.000000 
 0.714628  0.000000  0.000000  0.000000 
v = 
 0.000000 
-0.676838 
 0.491551 
 0.483984 
 0.218490 
 0.441684 
-0.073017 
-0.070963 
Yt_v = 
-0.054002 
 0.000000 
 0.000000 
 0.000000 
W = 
 0.654941  0.000000  0.000000  0.000000 
-0.442055  0.000000  0.000000  0.000000 
-0.287273  0.000000  0.000000  0.000000 
-0.003099  0.000000  0.000000  0.000000 
-0.594077  0.000000  0.000000  0.000000 
-0.133977  0.000000  0.000000  0.000000 
-0.482382  0.000000  0.000000  0.000000 
-0.594557  0.000000  0.000000  0.000000 
WYt_v = 
 0.059584 
-0.040217 
-0.026135 
-0.000282 
-0.054047 
-0.012189 
-0.043886 
-0.054091 
z = 
 0.059584 
 1.100046 
-0.854246 
-0.815644 
-0.422135 
-0.756289 
 0.079125 
 0.065460 
Y = 
-0.787206  0.000000  0.000000  0.000000 
 0.531328 -0.676838  0.000000  0.000000 
 0.345287  0.491551  0.000000  0.000000 
 0.003725  0.483984  0.000000  0.000000 
 0.714051  0.218490  0.000000  0.000000 
 0.161034  0.441684  0.000000  0.000000 
 0.579799 -0.073017  0.000000  0.000000 
 0.714628 -0.070963  0.000000  0.000000 
W = 
 0.654941  0.059584  0.000000  0.000000 
-0.442055  1.100046  0.000000  0.000000 
-0.287273 -0.854246  0.000000  0.000000 
-0.003099 -0.815644  0.000000  0.000000 
-0.594077 -0.422135  0.000000  0.000000 
-0.133977 -0.756289  0.000000  0.000000 
-0.482382  0.079125  0.000000  0.000000 
-0.594557  0.065460  0.000000  0.000000 
=====  i = 2  =====
Y = 
-0.787206  0.000000  0.000000  0.000000 
 0.531328 -0.676838  0.000000  0.000000 
 0.345287  0.491551  0.000000  0.000000 
 0.003725  0.483984  0.000000  0.000000 
 0.714051  0.218490  0.000000  0.000000 
 0.161034  0.441684  0.000000  0.000000 
 0.579799 -0.073017  0.000000  0.000000 
 0.714628 -0.070963  0.000000  0.000000 
v = 
 0.000000 
 0.000000 
-1.805536 
 0.271988 
-0.876521 
 0.220661 
-0.348006 
-0.024458 
Yt_v = 
-1.432015 
-0.822778 
 0.000000 
 0.000000 
W = 
 0.654941  0.059584  0.000000  0.000000 
-0.442055  1.100046  0.000000  0.000000 
-0.287273 -0.854246  0.000000  0.000000 
-0.003099 -0.815644  0.000000  0.000000 
-0.594077 -0.422135  0.000000  0.000000 
-0.133977 -0.756289  0.000000  0.000000 
-0.482382  0.079125  0.000000  0.000000 
-0.594557  0.065460  0.000000  0.000000 
WYt_v = 
 0.461969 
 0.127352 
-0.521568 
-0.316214 
-0.560803 
-0.381084 
-0.292876 
-0.373332 
z = 
 0.461969 
 0.127352 
 0.323597 
-0.443531 
-0.150507 
-0.484375 
-0.129976 
-0.361884 
Y = 
-0.787206  0.000000  0.000000  0.000000 
 0.531328 -0.676838  0.000000  0.000000 
 0.345287  0.491551 -1.805536  0.000000 
 0.003725  0.483984  0.271988  0.000000 
 0.714051  0.218490 -0.876521  0.000000 
 0.161034  0.441684  0.220661  0.000000 
 0.579799 -0.073017 -0.348006  0.000000 
 0.714628 -0.070963 -0.024458  0.000000 
W = 
 0.654941  0.059584  0.461969  0.000000 
-0.442055  1.100046  0.127352  0.000000 
-0.287273 -0.854246  0.323597  0.000000 
-0.003099 -0.815644 -0.443531  0.000000 
-0.594077 -0.422135 -0.150507  0.000000 
-0.133977 -0.756289 -0.484375  0.000000 
-0.482382  0.079125 -0.129976  0.000000 
-0.594557  0.065460 -0.361884  0.000000 
=====  i = 3  =====
Y = 
-0.787206  0.000000  0.000000  0.000000 
 0.531328 -0.676838  0.000000  0.000000 
 0.345287  0.491551 -1.805536  0.000000 
 0.003725  0.483984  0.271988  0.000000 
 0.714051  0.218490 -0.876521  0.000000 
 0.161034  0.441684  0.220661  0.000000 
 0.579799 -0.073017 -0.348006  0.000000 
 0.714628 -0.070963 -0.024458  0.000000 
v = 
 0.000000 
 0.000000 
 0.000000 
-0.174900 
-0.292896 
 0.097881 
 0.256731 
-0.244436 
Yt_v = 
-0.219860 
-0.106811 
 0.147392 
 0.000000 
W = 
 0.654941  0.059584  0.461969  0.000000 
-0.442055  1.100046  0.127352  0.000000 
-0.287273 -0.854246  0.323597  0.000000 
-0.003099 -0.815644 -0.443531  0.000000 
-0.594077 -0.422135 -0.150507  0.000000 
-0.133977 -0.756289 -0.484375  0.000000 
-0.482382  0.079125 -0.129976  0.000000 
-0.594557  0.065460 -0.361884  0.000000 
WYt_v = 
 0.653922 
 0.012209 
-1.606386 
-0.178273 
-1.220254 
-0.308748 
-0.623546 
-0.559489 
z = 
 0.653922 
 0.012209 
-1.606386 
 1.211927 
 1.107843 
-1.086758 
-2.664182 
 1.383418 
Y = 
-0.787206  0.000000  0.000000  0.000000 
 0.531328 -0.676838  0.000000  0.000000 
 0.345287  0.491551 -1.805536  0.000000 
 0.003725  0.483984  0.271988 -0.174900 
 0.714051  0.218490 -0.876521 -0.292896 
 0.161034  0.441684  0.220661  0.097881 
 0.579799 -0.073017 -0.348006  0.256731 
 0.714628 -0.070963 -0.024458 -0.244436 
W = 
 0.654941  0.059584  0.461969  0.653922 
-0.442055  1.100046  0.127352  0.012209 
-0.287273 -0.854246  0.323597 -1.606386 
-0.003099 -0.815644 -0.443531  1.211927 
-0.594077 -0.422135 -0.150507  1.107843 
-0.133977 -0.756289 -0.484375 -1.086758 
-0.482382  0.079125 -0.129976 -2.664182 
-0.594557  0.065460 -0.361884  1.383418 
===== COMPLETED W, Y UPDATE =====
W = 
 0.654941  0.059584  0.461969  0.653922 
-0.442055  1.100046  0.127352  0.012209 
-0.287273 -0.854246  0.323597 -1.606386 
-0.003099 -0.815644 -0.443531  1.211927 
-0.594077 -0.422135 -0.150507  1.107843 
-0.133977 -0.756289 -0.484375 -1.086758 
-0.482382  0.079125 -0.129976 -2.664182 
-0.594557  0.065460 -0.361884  1.383418 
Y = 
-0.787206  0.000000  0.000000  0.000000 
 0.531328 -0.676838  0.000000  0.000000 
 0.345287  0.491551 -1.805536  0.000000 
 0.003725  0.483984  0.271988 -0.174900 
 0.714051  0.218490 -0.876521 -0.292896 
 0.161034  0.441684  0.220661  0.097881 
 0.579799 -0.073017 -0.348006  0.256731 
 0.714628 -0.070963 -0.024458 -0.244436 
===== UPDATING Q,R =====
R[s:, s + r:]
 0.000000 
 0.000000 
 0.000000 
 0.000000 
 0.000000 
 0.000000 
 0.000000 
 0.000000 
dev_WTR = 




dev_YWTR








===== R BEFORE AXPY, k = 0 =====
 1.526856  1.233313  1.050548  0.917641 
 0.000000  0.876991  0.711011  0.205047 
 0.000000  0.000000  1.183201  0.452482 
 0.000000  0.000000 -0.000000  0.719321 
 0.000000 -0.000000  0.000000  0.000000 
 0.000000  0.000000 -0.000000 -0.000000 
 0.000000 -0.000000  0.000000 -0.000000 
 0.000000 -0.000000  0.000000  0.000000 
===== FINAL R AFTER BLOCK k = 0 =====
 1.526856  1.233313  1.050548  0.917641 
 0.000000  0.876991  0.711011  0.205047 
 0.000000  0.000000  1.183201  0.452482 
 0.000000  0.000000 -0.000000  0.719321 
 0.000000 -0.000000  0.000000  0.000000 
 0.000000  0.000000 -0.000000 -0.000000 
 0.000000 -0.000000  0.000000 -0.000000 
 0.000000 -0.000000  0.000000  0.000000 
first dgemm
R_rows - s = 8
r = 4
dev_W = 0x7020c1e00
R_rows= 8
dev_Y = 0x7020c1c00
r = 4
gamma = 0.000000
dev_WYT = 0x7020c2400
R_rows = 8
dev_WYT
-0.515573  0.307659 -0.578669  0.042557 -0.115776  0.297730  0.382498  0.292670 
 0.347988 -0.979429  0.158153  0.563260 -0.190504  0.443984 -0.377810 -0.400066 
 0.226143  0.425550 -1.103362 -0.045540 -0.204906 -0.509396 -0.629209  0.240071 
 0.002440  0.550412  0.398810 -0.727371 -0.146628 -0.340002  0.523249 -0.229725 
 0.467661 -0.029933 -0.140883 -0.441218 -0.708995 -0.206891  0.023172 -0.661703 
 0.105467  0.440700  0.456541 -0.308201  0.481964 -0.568871 -0.132897  0.235414 
 0.379734 -0.309858  0.107010  0.467112  0.567098 -0.332184 -0.924208  0.304062 
 0.468039 -0.360210  0.480278 -0.310921 -0.498241 -0.011274  0.131601 -0.758838 
second dgemm
===== FINAL Q AFTER BLOCK k = 0 =====
 0.484427  0.307659 -0.578669  0.042557 -0.115776  0.297730  0.382498  0.292670 
 0.347988  0.020571  0.158153  0.563260 -0.190504  0.443984 -0.377810 -0.400066 
 0.226143  0.425550 -0.103362 -0.045540 -0.204906 -0.509396 -0.629209  0.240071 
 0.002440  0.550412  0.398810  0.272629 -0.146628 -0.340002  0.523249 -0.229725 
 0.467661 -0.029933 -0.140883 -0.441218  0.291005 -0.206891  0.023172 -0.661703 
 0.105467  0.440700  0.456541 -0.308201  0.481964  0.431129 -0.132897  0.235414 
 0.379734 -0.309858  0.107010  0.467112  0.567098 -0.332184  0.075792  0.304062 
 0.468039 -0.360210  0.480278 -0.310921 -0.498241 -0.011274  0.131601  0.241162 
A = 
 0.739650  0.867264  0.042980  0.276388 
 0.531328  0.447219  0.567332  0.800273 
 0.345287  0.652109  0.417846  0.215248 
 0.003725  0.485716  0.865785  0.491661 
 0.714051  0.550522  0.303325  0.041883 
 0.161034  0.516564  0.964321  0.172027 
 0.579799  0.196588  0.305231  0.669348 
 0.714628  0.261337  0.803849  0.349297 
test_gpu_block_qr_deterministic4: Test PASSED
